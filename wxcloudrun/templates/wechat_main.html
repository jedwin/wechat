<!DOCTYPE html>
{% load static %}
<html lang="zh-cmn-Hans">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0,viewport-fit=cover">
    <meta name="wechat-enable-text-zoom-em" content="true">
    <title>{{ title }}</title>
    <link rel="stylesheet" href="{% static '/css/weui.css' %}"/>
    <link rel="stylesheet" href="{% static '/css/example.css' %}"/>
</head>
<body ontouchstart>
<script type="text/javascript">
      if(window.__wxWebEnv){
        document.body.style.webkitTextSizeAdjust = JSON.parse(window.__wxWebEnv.getEnv()).fontScale + '%';
      }

        function get_radio_value(radio_obj){
            for (i=0; i<radio_obj.length; i++){
                if (radio_obj[i].checked){
                    return radio_obj[i].value;
                }
            }
            return '';
        }
    </script>
<div class="container" id="container"></div>
<script type="text/html" id="tpl_home">
    <div class="page">
        <div class="page__hd">
            <h1 class="page__title">
                Jedwin's Game
            </h1>
            <p class="page__desc"><a href="/profile/?app_en_name={{ app_en_name }}&openid={{openid}}">{{user_name}}，你选择了{{ longitude}} {{ latitude }}</a></p>
        </div>
        <div class="weui-form">
            
               <form class="weui-cells__group weui-cells__group_form" action="/profile/" >
                <div class="weui-form__text-area">
                    <h2 class="weui-form__title">选择人物</h2>
                </div>
                <br>
                   <div class="weui-cells weui-cells_radio">
                   {% for charecter in char_list %}
                        <label class="weui-cell weui-cell_active weui-check__label">
                            <div class="weui-cell__bd">
                                <p>{{charecter.name}}</p>
                            </div>
                            <div class="weui-cell__hd">
                                <input type="radio" class="weui-check" name="radio1" id="radio1" value="{{charecter.name}}"/>
                                <span class="weui-icon-checked"></span>
                            </div>
                        </label>
                    {% endfor %}
                       <br>
                <div class="weui-form__text-area">
                    <h2 class="weui-form__title">选择动作</h2>
                </div>
                       <br>
                   {% for action in act_list %}
                    <label class="weui-cell weui-cell_active weui-check__label">
                        <div class="weui-cell__bd">
                            <p>{{action.name}}</p>
                        </div>
                        <div class="weui-cell__hd">
                            <input type="radio" class="weui-check" name="radio2" id="radio2" value="{{action.name}}"/>
                            <span class="weui-icon-checked"></span>
                        </div>
                    </label>
                {% endfor %}
                    </div>
            <br>
           <div class="page__bd page__bd_spacing">
               <a href="javascript:" role="button" class="weui-btn weui-btn_default" id="showIOSDialog1">开始提问</a>
           </div>
            <div id="dialogs">
               <div class="js_dialog" role="dialog"  aria-hidden="true" aria-modal="true" aria-labelledby="js_title1" id="iosDialog1" style="display: none;">
                   <div class="weui-mask"></div>
                   <div class="weui-dialog">
                       <div class="weui-dialog__hd"><strong class="weui-dialog__title" id="js_title1">确认问题</strong></div>
                       <div class="weui-dialog__bd" id="notice">你确认要选择这两个选项吗？</div>
                       <div class="weui-dialog__ft">
                           <a role="button" href="javascript:" class="weui-dialog__btn weui-dialog__btn_default" id="cancle">取消</a>
                           <a role="button" href="javascript:" class="weui-dialog__btn weui-dialog__btn_primary" id="confirm">确定</a>
                       </div>
                   </div>
               </div>
                   <input type="hidden" value="{{app_en_name}}" name="app_en_name" />
                   <input type="hidden" value="{{openid}}" name="openid" />
            </form>
        </div>
    </div>
    <script>
    $(function(){
        var $iosDialog1 = $('#iosDialog1');

        var $cancle = $('#cancle');
        var $confirm = $('#confirm');
        $('#dialogs').on('click', '.weui-dialog__btn_default', function(){
            $(this).parents('.js_dialog').fadeOut(200);
            $(this).parents('.js_dialog').attr('aria-hidden','true');
            $(this).parents('.js_dialog').removeAttr('tabindex');
        });

        $('#dialogs').on('click', '.weui-dialog__btn_primary', function(){
            char_name = $('input[name="radio1"]:checked').val();
		    act_name = $('input[name="radio2"]:checked').val();
		    $notice = $('#notice');
		    console.log($notice.textcontent);
		    if (char_name && act_name){
		        globalThis.location = "/profile/?app_en_name={{ app_en_name }}&openid={{openid}}&radio1="+char_name+"&radio2="+act_name;
		    }else{
		        $(this).parents('.js_dialog').fadeOut(200);
                $(this).parents('.js_dialog').attr('aria-hidden','true');
                $(this).parents('.js_dialog').removeAttr('tabindex');
		    }
        });
        
        $('#showIOSDialog1').on('click', function(){
            char_name = $('input[name="radio1"]:checked').val();
		    act_name = $('input[name="radio2"]:checked').val();
		    $notice = $('#notice');
		    if (char_name){
                if (act_name){
		            notice.innerHTML = '你确定要选'+char_name+'和'+act_name+'吗？';
		        }else{notice.innerHTML = '你还没选动作';}
		    }else{notice.innerHTML = '你还没选人物';}
            $iosDialog1.fadeIn(200);
            $iosDialog1.attr('aria-hidden','false');
            $iosDialog1.attr('tabindex','0');
            $iosDialog1.trigger('focus');

        });
    });


</script>
</script>


<script src="{% static '/js/zepto.min.js' %}"></script>
<script type="text/javascript" src="https://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
<script src="https://res.wx.qq.com/t/wx_fed/cdn_libs/res/weui/1.2.8/weui.min.js"></script>
<script src="static '/js/example.js' %} "></script>
<script src="static '/js/wah.js' %} "></script>


</body>
</html>