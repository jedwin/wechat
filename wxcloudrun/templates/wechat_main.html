<!DOCTYPE html>
<html lang="zh-cmn-Hans" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0,viewport-fit=cover">
    <meta name="wechat-enable-text-zoom-em" content="true">
    <title>{{ title }}</title>
    <link rel="stylesheet" href="/static/style/weui.css"/>
    <link rel="stylesheet" href="/static/style/example.css"/>
</head>
<body ontouchstart>
<script type="text/javascript">
      if(window.__wxWebEnv){
        document.body.style.webkitTextSizeAdjust = JSON.parse(window.__wxWebEnv.getEnv()).fontScale + '%';
      }

    </script>

<div class="container" id="container"></div>
<script type="text/html" id="tpl_home">
    <div class="page">
        <div class="page__hd">
            <h1 class="page__title">
                <img src="{{ head_image }}" alt="head image" height="21px"/>
            </h1>

        </div>


        <article class="weui-article">
            <h1>{{ cur_game_name }}</h1>
            <p>
                {{ opening }}
            </p>
        </article>

        <div class="weui-form">
            <form class="weui-cells__group weui-cells__group_form" action="/profile/" >
                <div class="weui-form__text-area">
                    <h2 class="weui-form__title">选择挑战</h2>
                </div>
                <br>
                <div class="weui-cells weui-cells_radio">
                    {% for trigger in quest_triggers %}
                    <label class="weui-cell weui-cell_active weui-check__label">
                        <div class="weui-cell__bd">
                            <p>{{trigger}}</p>
                        </div>
                        <div class="weui-cell__hd">
                            <input type="radio" class="weui-check" name="quest" id="quest" value="{{trigger}}"/>
                            <span class="weui-icon-checked"></span>
                        </div>
                    </label>
                    {% endfor %}
                </div>
                <br>
                <div class="page__bd page__bd_spacing">
                    <a href="javascript:" role="button" class="weui-btn weui-btn_default" id="showIOSDialog1">选择你的挑战</a>
                </div>
                <div id="dialogs">
                    <div class="js_dialog" role="dialog"  aria-hidden="true" aria-modal="true" aria-labelledby="js_title1" id="iosDialog1" style="display: none;">
                        <div class="weui-mask"></div>
                        <div class="weui-dialog">
                            <div class="weui-dialog__hd"><strong class="weui-dialog__title" id="js_title1">确认挑战</strong></div>
                            <div class="weui-dialog__bd" id="notice">你确认要选这个挑战吗？</div>
                            <div class="weui-dialog__ft">
                                <a role="button" href="javascript:" class="weui-dialog__btn weui-dialog__btn_default" id="cancle">取消</a>
                                <a role="button" href="javascript:" class="weui-dialog__btn weui-dialog__btn_primary" id="confirm">确定</a>
                            </div>
                        </div>
                    </div>
                    <input type="hidden" value="{{app_en_name}}" name="app_en_name" />
                    <input type="hidden" value="{{openid}}" name="openid" />
                </div>
            </form>
        </div>
    </div>
    <script>
    $(function(){
        var $iosDialog1 = $('#iosDialog1');
        var $cancle = $('#cancle');
        var $confirm = $('#confirm');
        $('#dialogs').on('click', '.weui-dialog__btn_default', function(){
            $(this).parents('.js_dialog').fadeOut(200);
            $(this).parents('.js_dialog').attr('aria-hidden','true');
            $(this).parents('.js_dialog').removeAttr('tabindex');
        });

        $('#dialogs').on('click', '.weui-dialog__btn_primary', function(){
            my_trigger = $('input[name="quest"]:checked').val();
		    $notice = $('#notice');
		    if (my_trigger){
		        globalThis.location = "/profile/?app_en_name={{ app_en_name }}&cur_game_name={{cur_game_name}}&openid={{openid}}&cmd="+my_trigger;
		    }else{
		        $(this).parents('.js_dialog').fadeOut(200);
                $(this).parents('.js_dialog').attr('aria-hidden','true');
                $(this).parents('.js_dialog').removeAttr('tabindex');
		    }
        });

        $('#showIOSDialog1').on('click', function(){
            my_trigger = $('input[name="quest"]:checked').val();
		    $notice = $('#notice');
		    if (my_trigger){
		        notice.innerHTML = '你确定要挑战 '+my_trigger+' 吗？';
		    }else{notice.innerHTML = '你还没做出选择'+my_trigger;}
            $iosDialog1.fadeIn(200);
            $iosDialog1.attr('aria-hidden','false');
            $iosDialog1.attr('tabindex','0');
            $iosDialog1.trigger('focus');

        });
    });

</script>
</script>

<script src="/static/js/zepto.min.js"></script>
<script type="text/javascript" src="https://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
<script src="https://res.wx.qq.com/t/wx_fed/cdn_libs/res/weui/1.2.8/weui.min.js"></script>
<script src="/static/js/example.js"></script>
<script src="/static/js/wah.js"></script>


</body>
</html>